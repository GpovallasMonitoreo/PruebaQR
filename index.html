<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Argos AR: Hologram Core</title>
    
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>

    <style>
        body { margin: 0; background: #000; overflow: hidden; }
        
        /* UI SUPERIOR */
        #hud {
            position: absolute; top: 20px; left: 20px; z-index: 10;
            font-family: 'Courier New', Courier, monospace;
            color: #00ffff; pointer-events: none;
        }
        .line { border-left: 2px solid #00ffff; padding-left: 10px; margin-bottom: 5px; opacity: 0; animation: fadeIn 0.5s forwards; }
        .line:nth-child(2) { animation-delay: 0.2s; }
        .line:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes fadeIn { to { opacity: 1; } }

        /* MIRA DE ESCANEO */
        #scanner {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px; height: 300px;
            border: 2px solid rgba(0, 255, 255, 0.3); border-radius: 50%;
            z-index: 5; pointer-events: none;
        }
        #scanner::after {
            content: ''; position: absolute; top: -5px; left: -5px; right: -5px; bottom: -5px;
            border: 2px solid transparent; border-top-color: #00ffff; border-bottom-color: #00ffff;
            border-radius: 50%; animation: spin 4s linear infinite;
        }
        .hidden { display: none !important; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>

    <script>
        AFRAME.registerComponent('hologram-logic', {
            init: function () {
                const el = this.el;
                const scanner = document.querySelector('#scanner');
                const hudLines = document.querySelectorAll('.line');
                const core = document.querySelector('#core-group');
                
                // Ocultar el núcleo al inicio
                core.setAttribute('visible', false);

                el.addEventListener('targetFound', () => {
                    scanner.style.borderColor = "#00ff00"; // Verde al encontrar
                    scanner.classList.add('hidden'); // Quitar mira
                    
                    hudLines[0].innerText = "SYSTEM: ONLINE";
                    hudLines[1].innerText = "TARGET: VERIFIED";
                    hudLines[2].innerText = "RENDER: HOLOGRAPHIC";

                    core.setAttribute('visible', true);
                    
                    // Animación de entrada "Pop"
                    core.setAttribute('animation', {
                        property: 'scale',
                        from: '0 0 0',
                        to: '0.5 0.5 0.5', // Ajusta tamaño aquí
                        dur: 1000,
                        easing: 'easeOutElastic'
                    });
                });

                el.addEventListener('targetLost', () => {
                    scanner.classList.remove('hidden');
                    scanner.style.borderColor = "rgba(0, 255, 255, 0.3)";
                    hudLines[0].innerText = "SYSTEM: SEARCHING...";
                    hudLines[1].innerText = "TARGET: ---";
                    core.setAttribute('visible', false);
                    core.setAttribute('scale', '0 0 0');
                });
            }
        });
    </script>
</head>
<body>

    <div id="hud">
        <div class="line">SYSTEM: INITIALIZING...</div>
        <div class="line">TARGET: WAITING</div>
        <div class="line">RENDER: STANDBY</div>
    </div>

    <div id="scanner"></div>

    <a-scene 
        mindar-image="imageTargetSrc: ./targets.mind; uiLoading: no; uiScanning: no;" 
        color-space="sRGB" 
        renderer="colorManagement: true, physicallyCorrectLights, alpha: true" 
        vr-mode-ui="enabled: false" 
        device-orientation-permission-ui="enabled: false">

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <a-entity mindar-image-target="targetIndex: 0" hologram-logic>
            
            <a-entity id="core-group" visible="false">

                <a-icosahedron color="#00ffff" radius="1" opacity="0.8" wireframe="true">
                    <a-animation attribute="rotation" to="360 360 0" dur="8000" repeat="indefinite" easing="linear"></a-animation>
                    <a-light type="point" color="#00ffff" intensity="2" distance="5">
                         <a-animation attribute="intensity" from="1" to="3" dir="alternate" dur="1000" repeat="indefinite"></a-animation>
                    </a-light>
                </a-icosahedron>
                
                <a-sphere color="white" radius="0.2" opacity="0.9">
                     <a-animation attribute="scale" from="0.9 0.9 0.9" to="1.1 1.1 1.1" dir="alternate" dur="500" repeat="indefinite"></a-animation>
                </a-sphere>

                <a-torus color="#0088ff" radius="1.4" radius-tubular="0.02" arc="300" rotation="45 0 0" opacity="0.6">
                    <a-animation attribute="rotation" to="45 360 0" dur="4000" repeat="indefinite" easing="linear"></a-animation>
                </a-torus>

                <a-torus color="#00ffff" radius="1.8" radius-tubular="0.01" arc="360" rotation="0 0 45" opacity="0.4">
                    <a-animation attribute="rotation" to="360 0 45" dur="6000" repeat="indefinite" easing="linear"></a-animation>
                </a-torus>

                <a-entity rotation="0 0 0">
                    <a-animation attribute="rotation" to="0 -360 0" dur="5000" repeat="indefinite" easing="linear"></a-animation>
                    <a-sphere color="#fff" radius="0.05" position="2 0 0"></a-sphere>
                    <a-sphere color="#fff" radius="0.05" position="-2 0 0"></a-sphere>
                </a-entity>

                <a-circle rotation="-90 0 0" radius="3" opacity="0.3" color="#00ffff" position="0 -1.5 0" wireframe="true"></a-circle>
                
                <a-text value="ARGOS SYSTEM v1.0" color="#00ffff" align="center" position="0 2.2 0" width="6"></a-text>

            </a-entity>

        </a-entity>
    </a-scene>
</body>
</html>
